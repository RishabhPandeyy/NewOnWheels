<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>MechWay Admin</title>
    <style>
      body{font-family:system-ui,Arial;background:#071024;color:#e6f1ff;padding:2rem}
      .card{background:#0d2336;padding:1rem;border-radius:8px;margin-bottom:1rem}
      textarea{width:100%;height:300px;background:#07111f;color:#e6f1ff}
      input{padding:.5rem;width:100%;margin-bottom:.5rem}
      button{padding:.6rem 1rem}
    </style>
  </head>
  <body>

    <h1>MechWay â€” Admin Submissions</h1>
    <p>Enter your <strong>admin key</strong> (same as <code>ADMIN_KEY</code> in server .env) to view recent submissions.</p>
    <input id="adminKey" placeholder="Enter admin key" />
    <button id="load">Load Submissions</button>
    <div id="status"></div>
    <div class="card"><h3>Contacts</h3><textarea id="contacts" readonly></textarea></div>
    <div class="card"><h3>Bookings</h3><textarea id="bookings" readonly></textarea></div>
    <div class="card"><h3>Inquiries</h3><textarea id="inquiries" readonly></textarea></div>

    <script>
      document.getElementById('load').addEventListener('click', async ()=>{
        const key = document.getElementById('adminKey').value.trim();
        if(!key){ alert('Enter admin key'); return; }
        document.getElementById('status').textContent = 'Loading...';
        try{
          const res = await fetch('/api/admin/submissions', { headers: { 'x-admin-key': key }});
          if(!res.ok){ throw new Error((await res.json()).error || 'Unauthorized'); }
          const data = await res.json();
          document.getElementById('contacts').value = JSON.stringify(data.contacts, null, 2);
          document.getElementById('bookings').value = JSON.stringify(data.bookings, null, 2);
          document.getElementById('inquiries').value = JSON.stringify(data.inquiries, null, 2);
          document.getElementById('status').textContent = 'Loaded';
        }catch(err){
          document.getElementById('status').textContent = 'Error: ' + err.message;
        }
      });
    </script>
  </body>
</html>
